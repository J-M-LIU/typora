# æœ€ä¼˜åŒ–æ–¹æ³•è¯¾ç¨‹å¤§ä½œä¸š



## Task1: æ ¸èŒƒæ•°ï¼ŒçŸ©é˜µè¡¥å…¨ï¼Œæ¡ä»¶æ¢¯åº¦

### æ¡ä»¶æ¢¯åº¦æ³•	

æ¡ä»¶æ¢¯åº¦æ³•çš„æ€æƒ³æ˜¯åœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­é€šè¿‡æ±‚è§£ä¸€ä¸ªçº¿æ€§çš„å­é—®é¢˜å¾—åˆ°æœ€ä¼˜ çš„ä¸‹é™æ–¹å‘ï¼Œåœ¨æ›´æ–°æ­¥æ—¶ä¸ä¸Šä¸€æ­¥çš„è¿­ä»£ç‚¹å‡¸ç»„åˆå¾—åˆ°ä¸‹ä¸€æ­¥çš„è¿­ä»£ç‚¹ã€‚å…¶ç®—æ³•æè¿°å¦‚ä¸‹:
$$
ğ‘šğ‘–ğ‘›_ğ‘¥ = ğ‘“(ğ‘¥)
$$
åœ¨å½“å‰è¿­ä»£ç‚¹ $x^{(k)}$â€‹å¤„ï¼Œè¯¥ç®—æ³•è€ƒè™‘ç›®æ ‡å‡½æ•°çš„çº¿æ€§åŒ–ï¼Œå¹¶æ±‚è§£å‡ºè¯¥çº¿æ€§å‡½æ•°çš„æœ€å°å€¼(å®šä¹‰åŸŸç›¸åŒ)ã€‚è¿­ä»£ç®—æ³•ä¸ºï¼š
$$
ğ‘¥_{ğ‘˜+1} = ğ‘¥_ğ‘˜ + ğœ‚_ğ‘˜(\hat{x}_ğ‘˜ âˆ’ ğ‘¥_ğ‘˜)
$$
å…¶ä¸­: $\hat{x}_ğ‘˜ = argmin _{ğ‘¥âˆˆÎ©}ã€ˆâˆ‡ğ‘“(ğ‘¥_ğ‘˜),ğ‘¥ã€‰$

### æ ¸èŒƒæ•°

æ ¸èŒƒæ•°å³ä¸º 1-èŒƒæ•°æˆ–è€…è¿¹èŒƒæ•°ï¼Œå¯ä»¥ç”±çŸ©é˜µ A çš„å¥‡å¼‚å€¼åˆ†è§£æ¥è®¡ç®—ï¼Œå…¶è®¡ç®—æ–¹æ³•ä¸º:
$$
â€–ğ´â€–_âˆ— =\sum_i \sigma_ğ‘–(ğ´)
$$
æ ¸èŒƒæ•°çš„å•ä½çƒå®šä¹‰ä¸º:
$$
B_*^{m\times n} = \{A\in R^{m\times n} ||A||_* \leq1 \}
$$
å°†çŸ©é˜µ A(æ ¸èŒƒæ•°çƒå¤–)æŠ•å½±åˆ°æ ¸èŒƒæ•°çƒå†…:
$$
\prod_{B_{*}}(A)=\underset{X \in B_{*}}{\arg \min }\|A-X\|_{F}^{2}
$$
å¯ä»¥å°†è¯¥é—®é¢˜åŒ–ä¸º A çŸ©é˜µ SVD åˆ†è§£åçš„å¥‡å¼‚å€¼å‘é‡åœ¨å•çº¯å½¢ä¸Šçš„æŠ•å½±:
$$
\begin{array}{c}
A=U S V^{T} \\
S=\operatorname{diag}\left\{\sigma_{1, \cdots, \sigma_{k}}\right\} \\
\Delta_{n}=\left\{x \in R^{k}: \sum_{i=1}^{k} x_{i}=1, x \geq 0\right\} \\
\prod_{\Delta_{n}}(S)=\underset{X \epsilon_{\Delta_{n}}}{\arg \min } \frac{1}{2}\|S-X\|_{2}^{2}
\end{array}
$$
è¯¥é—®é¢˜ä¸ºå‡¸è§„åˆ’é—®é¢˜ï¼Œåªè¦æ±‚ KKT ç‚¹å³å¯:
$$
\begin{array}{c}
L(S, \theta)=\frac{1}{2}\|S-X\|_{2}^{2}+\theta \sum_{i=1}^{k} x_{i} \\
S-X+\theta \underbrace{[1, \cdots, 1]^{T}}_{k}=0 \\
\sum_{i=1}^{k} x_{i}=1
\end{array}
$$
è§£å¾—
$$
\begin{array}{c}
\theta=\frac{1}{n}\left(\sum_{i=1}^{k} \sigma_{i}-1\right) \\
x_{i}=\sigma_{i}-\theta=\sigma_{i}-\frac{1}{n}\left(\sum_{i=1}^{k} \sigma_{i}-1\right)
\end{array}
$$
ä½†ç”±äºå¥‡å¼‚å€¼éœ€è¦ä¸ºæ­£ï¼Œåœ¨è®¡ç®—å¾—åˆ°æŠ•å½±ç»“æœåéœ€è¦å°† $x_i$ å°äº 0 çš„æ•°è¿›è¡Œæˆªæ–­ã€‚ æœ€ç»ˆå¾—åˆ°åœ¨æ ¸èŒƒæ•°çƒé‡Œçš„æŠ•å½±ä¸º
$$
\Pi_{B *}(A)=U X V^{T}
$$

### æŠ•å½±æ¢¯åº¦ä¸‹é™æ³•

â€‹	æ¢¯åº¦æŠ•å½±æ³•(gradient projection method)åˆ©ç”¨æ¢¯åº¦çš„æŠ•å½±æŠ€å·§æ±‚çº¦æŸéçº¿æ€§ è§„åˆ’é—®é¢˜æœ€ä¼˜è§£çš„ä¸€ç§æ–¹æ³•ã€‚
â€‹	æ±‚å¸¦çº¿æ€§çº¦æŸçš„éçº¿æ€§è§„åˆ’é—®é¢˜æ›´ä¸ºæœ‰æ•ˆã€‚å®ƒæ˜¯ä»ä¸€ä¸ªåŸºæœ¬å¯è¡Œè§£å¼€å§‹ï¼Œç”± çº¦æŸæ¡ä»¶ç¡®å®šå‡ºå‡¸çº¦æŸé›†è¾¹ç•Œä¸Šæ¢¯åº¦çš„æŠ•å½±ï¼Œä»¥ä¾¿æ±‚å‡ºä¸‹æ¬¡çš„æœç´¢æ–¹å‘å’Œæ­¥é•¿ã€‚ æ¯æ¬¡æœç´¢åï¼Œéƒ½è¦è¿›è¡Œæ£€éªŒï¼Œç›´åˆ°æ»¡è¶³ç²¾åº¦è¦æ±‚ä¸ºæ­¢ã€‚è¿™ç§æ–¹æ³•æ˜¯ç½—æ£®äº 1960 å¹´æå‡ºçš„ï¼Œæˆˆå¾·ç¦å¸ƒå’Œæ‹‰åŒ¹å¡”æ–¯äº 1968 å¹´ä½œäº†æ”¹è¿›ã€‚
â€‹	æœ¬æ¬¡è¯¾ç¨‹ä½œä¸šä½¿ç”¨çš„æ˜¯æŠ•å½±æ¢¯åº¦ä¸‹é™æ³•(PGDA)ï¼Œæ–¹æ³•ä¸»è¦ç”¨äºåœ¨å‡¸é›†ä¸Šæå°åŒ–å‡¸å‡½æ•°ï¼Œç®—æ³•å¤æ‚æ€§ä¸º $O(1/\sqrt{t})$ã€‚å› ä¸ºæ¯è½®æ¢¯åº¦ä¸‹é™è¿­ä»£çš„ç‚¹å¯èƒ½åœ¨æŠ•å½±åŒºåŸŸå¤–ï¼Œè¦å¤šåŠ ä¸€ä¸ªæŠ•å½±æ­¥å°†å…¶æŠ•å½±å›å‡¸é›†çº¦æŸä¸Šã€‚å› æ­¤æŠ•å½±æ¢¯åº¦æ³•åˆ†ä¸ºä¸¤æ­¥ï¼Œæ¢¯åº¦æ­¥å’ŒæŠ•å½±æ­¥ã€‚
â€‹	åœ¨è¯¥é—®é¢˜ä¸­æŠ•å½±æ¢¯åº¦æ³•ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥:
â€‹	æ¢¯åº¦æ­¥ï¼š  $Y_{t+1}=X_{t}-\eta \nabla f\left(X{t}\right)$ 
â€‹	æŠ•å½±æ­¥ï¼š  $X{t+1}=\Pi_{B .}\left(Y_{t+1}\right)$ 
â€‹	ç”±äºé«˜ç»´çŸ©é˜µæŠ•å½±åœ¨æ ¸èŒƒæ•°å•ä½çƒä¸Šæ‰€èŠ±è´¹çš„æ—¶é—´è¾ƒé•¿ï¼Œè¿™ä¹Ÿè¿›ä¸€æ­¥æ‹–æ…¢äº† ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£ã€‚è€Œæ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œæ¡ä»¶æ¢¯åº¦æ³•æ— éœ€è®¡ç®—æŠ•å½±æ­¥ï¼Œåªéœ€è¦æ±‚è§£ çº¿æ€§æœ€ä¼˜åŒ– oracleï¼Œèƒ½æœ‰æ•ˆç¼©çŸ­æ—¶é—´ã€‚

### æ¡ä»¶æ¢¯åº¦æ³•

â€‹	æ¡ä»¶æ¢¯åº¦æ³•ï¼Œä¹Ÿè¢«ç§°ä¸º FrankWolfe(FW)ç®—æ³•ï¼Œè¯¥æ–¹æ³•çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³ åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŠ•å½±æ¢¯åº¦ä¸‹é™æ³•ä¸­çš„å­˜åœ¨ä½æ•ˆæŠ•å½±æ­¥éª¤çš„é—®é¢˜ã€‚è¯¥æ–¹æ³•æ˜¯æŠ•å½±æ¢¯ åº¦ä¸‹é™æ³•çš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå› æ­¤è¯¥æ–¹æ³•ä¹Ÿæ˜¯ç”¨äºåœ¨æœ‰ç•Œå‡¸é›†ä¸Šæå°åŒ–å‡½æ•°ã€‚å¹¶ä¸”è¯¥ç®—æ³•çš„å¤æ‚æ€§åœ¨å‡½æ•°å…‰æ»‘å‡¸çš„æ¡ä»¶ä¸‹ä¸º $O(1/t)$ã€‚
â€‹	åœ¨è¯¥é—®é¢˜ä¸­æŠ•å½±æ¢¯åº¦æ³•ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥:
â€‹	çº¿æ€§ä¼˜åŒ–æ­¥: $\bar{X}_{t}=\underset{X \in B^{m n n}}{\arg \max }\langle Z, X\rangle$
â€‹	æ›´æ–°æ­¥ : $ X_{t+1}=X_{t}+\eta_{t}\left(\bar{X}_{t}-X_{t}\right)$

â€‹	è€Œå¯¹äºçŸ©é˜µè¡¥å…¨é—®é¢˜ï¼Œçº¿æ€§ä¼˜åŒ–é—®é¢˜è½¬å˜ä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼š
$$
\begin{array}{c}
\bar{X}_{t} \in \underset{X \in B_{*}}{\operatorname{argmin}} \nabla f\left(X_{t}\right)^{\top} X \\
\nabla f(X)=Y-X \odot O
\end{array}
$$
æ ¹æ®å¯¹æ ¸èŒƒæ•°å•ä½çƒæ˜¯ç§©-1 çŸ©é˜µçš„å‡¸åŒ…çš„åˆ†æï¼Œä¸ºäº†è§£å†³è¿™ä¸ªçº¿æ€§ä¼˜åŒ–é—® é¢˜ï¼Œä»…éœ€è¦è®¡ç®—çŸ©é˜µæœ€å¤§å·¦å¥‡å¼‚å€¼çš„æ–¹æ³•ï¼Œä¸ºæ­¤å¼•å…¥ç»å…¸å¹‚æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
$$
Pick\ a \ random\  unit \ vector \  x_{1} \  and \ let \  y_{1}=A^{\top} x /\left\|A^{\top} x\right\| .\\
From  \ k=1  \ to \  k=T-1  :\\
- Put \  x_{k+1}=\frac{A y_{k}}{\left\|A y_{k}\right\|} \\
- Put \  y_{k+1}=\frac{A^{\top} x_{k+1}}{\left\|A^{\top} x_{k+1}\right\|} \\
Return \  x_{T}\   and \  y_{T} \  as \ approximate \ top\  left\  and \ right \ singular\  vectors.
$$

### å®éªŒå’Œç»“æœ

#### æ ¸èŒƒæ•°çƒæŠ•å½±æ—¶é—´åˆ†æ

â€‹	éšæœºç”Ÿæˆ 1000ã€2000ã€3000 å’Œ 4000 ç»´çš„çŸ©é˜µï¼Œåˆ†åˆ«æŠ•å½±åˆ°å•ä½æ ¸èŒƒæ•°çƒå†…ã€‚1000 ç»´çŸ©é˜µçš„æŠ•å½±æ—¶é—´ä¸ºï¼š0.93sï¼Œ2000 ç»´ä¸º 4.61sï¼Œ3000 ç»´ä¸º 13.53sï¼Œ4000 ç»´ä¸º 30.28sï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œéšç€ç»´æ•°å¢åŠ ï¼ŒæŠ•å½±æ­¥æ‰€éœ€è¦çš„æ—¶é—´å¢åŠ ï¼Œ å½“çŸ©é˜µç»´æ•°è¿‡å¤§æ—¶ï¼Œé‡‡ç”¨æŠ•å½±æ¢¯åº¦æ³•è¿›è¡Œä¼˜åŒ–çš„æ—¶é—´å°†è¿‡é•¿ã€‚
â€‹	æ ¸èŒƒæ•°æ±‚è§£ä¸æ˜¯ä¸€ä¸ªç®€å•çš„æ“ä½œã€‚å®ƒéœ€è¦è¾“å…¥çŸ©é˜µçš„å®Œæ•´ SVDï¼Œé€šå¸¸éœ€è¦ æ­¥æ•°çš„ç«‹æ–¹å€çš„è¿­ä»£æ¬¡æ•°ã€‚ä»¥ç¨‹åº 5-1-nuclear norm projection ä¸ºä¾‹å­è¯´ æ˜ï¼Œå³ä½¿åœ¨è¾ƒå°çš„æ­¥æ•°å¤§å°ä¸Šï¼Œå•ä¸ªæŠ•å½±æ­¥éª¤ä¹Ÿæ˜¯è€—æ—¶çš„ã€‚

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218140301938.png" alt="image-20221218140301938" style="zoom:40%;" />

#### ä½é˜¶çŸ©é˜µè¡¥å…¨

â€‹	åˆ©ç”¨éšæœºæ•°ç”Ÿæˆç§©ä¸º 10ï¼Œç»´æ•°ä¸º 1000 çš„çŸ©é˜µï¼Œå°†å…¶è¡¨ç¤ºä¸ºA=USU^T^ çš„å½¢å¼ï¼ŒS ä¸ºç”±å¥‡å¼‚å€¼ç»„æˆçš„å¯¹è§’é˜µï¼Œå¯¹ A è¿›è¡Œæ•°æ®é‡‡é›†ï¼Œåˆ›å»ºæŸå¤±å‡½æ•°è®¡ç®—å‡½æ•°ã€‚

```python
# random rank-10 matrix normalized to have nuclear norm 1 U = np.random.normal(0, 1, (n, k))
U = np.linalg.qr(U)[0]
S = np.diag(np.random.uniform(0, 1, k))
S /= np.sum(S)
A = U.dot(S.dot(U.T))
# pick which entries we observe uniformly at random O = np.random.randint(0,2, (n, n))
# multiply A by O coordinate-wise
Y = np.multiply(A, O)
def mc_objective(Y, O, X):
  """Matrix completion objective."""
  return 0.5 * np.linalg.norm(Y-np.multiply(X, O), 'fro')**2
def mc_gradient(Y, O, X):
"""Gradient of matrix completion objective.""" 
	return np.multiply(X, O) - Y
```

â€‹	åˆ©ç”¨æŠ•å½±æ¢¯åº¦ä¸‹é™ç®—æ³•ä½œä¸ºä¼˜åŒ–å™¨å¯¹é¢„æµ‹çŸ©é˜µè¿›è¡Œä¼˜åŒ–:

```python
# start from random matrix of nuclear norm 1
X0 = np.random.normal(0,1, (n,n))
X0 = nuclear_projection(X0.dot(X0.T))
objective = lambda X: mc_objective(Y, O, X)
gradient = lambda X: mc_gradient(Y, O, X)
Xs = gradient_descent(X0, [0.2]*40, gradient, nuclear_projection)
```

â€‹	å¾—åˆ°çš„èŒƒæ•°è¯¯å·®å¦‚ä¸‹:

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218140816506.png" alt="image-20221218140816506" style="zoom:50%;" />

â€‹	ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºæŠ•å½±æ¢¯åº¦æ³•ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡å‡½æ•°å€¼é€’å‡ï¼Œå¹¶ä¸”è¡¥å…¨çŸ©é˜µå’ŒåŸçŸ©é˜µçš„è¯¯å·®ä¸æ–­ç¼©å°ã€‚æ¥ä¸‹æ¥è¿›ä¸€æ­¥åˆ†æè¡¥å…¨çŸ©é˜µçš„å¥‡å¼‚å€¼ï¼Œå¦‚å›¾ä¸‹å›¾æ‰€ç¤ºã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°è¡¥å…¨çŸ©é˜µåœ¨å¥‡å¼‚å€¼çš„è¿˜åŸä¸Šå¹¶ä¸ç†æƒ³ï¼ŒåŸçŸ©é˜µ 10 ä¸ªå¥‡å¼‚å€¼ï¼Œè¡¥å…¨çŸ©é˜µ ç¬¬ 11 ä¸ªå¥‡å¼‚å€¼å¼€å§‹è¿˜å…·æœ‰ä¸€å®šçš„å€¼ï¼Œå¹¶æœªè¶‹äº 0ã€‚

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218141116268.png" alt="image-20221218141116268" style="zoom:50%;" />

â€‹	åˆ©ç”¨æ¡ä»¶æ¢¯åº¦ä¸‹é™ç®—æ³•ä½œä¸ºä¼˜åŒ–å™¨å¯¹é¢„æµ‹çŸ©é˜µè¿›è¡Œä¼˜åŒ–:

```python
def conditional_gradient(initial, steps, oracle):
  xs = [initial]
  for step in steps:
  xs.append(xs[-1] + step*(oracle(xs[-1])-xs[-1])) return xs
def power_method(A, num_steps=10): m, n = A.shape
  x = np.random.normal(0,1, m) x /= np.linalg.norm(x)
  y = A.T.dot(x)
  y /= np.linalg.norm(y)
  for _ in range(num_steps):
    x = A.dot(y)
    x /= np.linalg.norm(x) y = A.T.dot(x)
    y /= np.linalg.norm(y)
    return x, y
```

â€‹	çº¿æ€§ä¼˜åŒ–æœç´¢å½’ç»“ä¸ºè®¡ç®—çŸ©é˜µè´Ÿæ¢¯åº¦çš„æœ€ä½³ä¸€é˜¶è¿‘ä¼¼.

```python
def mc_oracle(Y, O, X):
    """Linear optimization oracle for matrix completion.""" G = mc_gradient(Y, O, X)
    x, y = power_method(-G)
    return x.reshape((len(x), 1)).dot(y.reshape((1,len(y))))
n, k = 1000, 10
# random rank-10 matrix normalized to have nuclear norm 1
U = np.random.normal(0, 1, (n, k))
U = np.linalg.qr(U)[0]
S = np.diag(np.random.uniform(0, 1, k))
S /= np.sum(S)
A = U.dot(S.dot(U.T))
# pick which entries we observe uniformly at random O = np.random.randint(0,2, (n, n))
# multiply A by O coordinate-wise
Y = np.multiply(A, O)
X0 = np.random.normal(0,1, (n,n))
X0 = nuclear_projection(X0.dot(X0.T))
oracle = lambda X: mc_oracle(Y, O, X) steps = [2./(k+2.) for k in range(1, 40)] Xs = conditional_gradient(X0, steps, oracle)
```

â€‹	å¾—åˆ°çš„èŒƒæ•°è¯¯å·®å¦‚ä¸‹:

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218141449489.png" alt="image-20221218141449489" style="zoom:50%;" />

â€‹	å¯¹å¥‡å¼‚å€¼åˆ†è§£åçš„æœ€å¤§å¥‡å¼‚å€¼è¿›è¡Œæ¯”è¾ƒ:	

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218141529224.png" alt="image-20221218141529224" style="zoom:40%;" />

â€‹	æ¯”è¾ƒçŸ©é˜µèŒƒæ•°è¯¯å·®å’Œå¥‡å¼‚å€¼çš„è¯¯å·®å‘ç°ä¸¤ä¸ªä¼˜åŒ–å™¨æ•ˆæœéƒ½å¾ˆå¥½ï¼Œè¯¯å·®è¾ƒå°æ¯”è¾ƒä¸¤è€…ä¼˜åŒ–è®¡ç®—æ‰€éœ€æ—¶é—´:	

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218141627213.png" alt="image-20221218141627213" style="zoom:40%;" />

â€‹	ä»å›¾ä¸­å¯çŸ¥ï¼Œæ¡ä»¶æ¢¯åº¦æ³•ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡å‡½æ•°å€¼å’Œå®é™…è¯¯å·®æ€»ä½“ä¸Šæ˜¯å‡å°çš„ï¼Œè™½ç„¶å…·æœ‰ä¸Šå‡çš„æ³¢åŠ¨ï¼Œä½†æœ€ç»ˆè¯¯å·®æ”¶æ•›åˆ°ä¸€ä¸ªè¾ƒä½çš„æ°´å¹³ã€‚åŒæ ·çš„è¿­ä»£æ­¥æ•°ä¸‹å’Œ æŠ•å½±æ¢¯åº¦æ³•ç›¸æ¯”ï¼Œæ¡ä»¶æ¢¯åº¦æ³•çš„æœ€ç»ˆè¯¯å·®å¤§ä½“ç›¸å¤§ï¼Œä½†æ‰€èŠ±è´¹æ—¶é—´è¦æ˜æ˜¾çš„çŸ­ã€‚ å¯ä»¥çœ‹å‡ºè¡¥å…¨çŸ©é˜µçš„å¥‡å¼‚å€¼ä¸åŸçŸ©é˜µå…·æœ‰ä¸€è‡´æ€§ï¼Œç‰¹åˆ«æ˜¯ä»ç¬¬ 11 ä¸ªå¥‡å¼‚å€¼å¼€å§‹å€¼è¶‹äº 0ï¼Œè¾ƒå¥½è¿˜åŸäº†çŸ©é˜µçš„ä½ç§©ç‰¹æ€§ã€‚å› æ­¤ï¼Œåœ¨è¯¥é—®é¢˜ä¼˜åŒ–æ±‚è§£ä¸­æ¡ä»¶æ¢¯åº¦æ³•æ— è®ºæ˜¯æ—¶é—´è¿˜æ˜¯ç»“æœç²¾åº¦ä¸Šéƒ½è¦ä¼˜äºæŠ•å½±æ¢¯åº¦æ³•ï¼Œä¸”è¾“å…¥ç»´æ•°è¶Šå¤§æ•ˆæœè¶Šæ˜æ˜¾ã€‚



## Task2ï¼šäº¤æ›¿æå°åŒ–ä¸ EM ç®—æ³•

### é—®é¢˜èƒŒæ™¯

â€‹	åœ¨ä¸€äº›å…·ä½“ä»»åŠ¡ä¸­(ä¾‹å¦‚å›¾åƒå¤„ç†ã€ç”¨æˆ·è¯„ä»·)ï¼Œå¾€å¾€æ— æ³•æ”¶é›†æ‰€æœ‰çš„ä¿¡æ¯ï¼Œä½†è¿™äº›ä¿¡æ¯åˆå‘ˆ ç°é«˜åº¦çš„ç›¸å…³æ€§ï¼Œå› æ­¤æƒ³æ‰¾åˆ°ä½ç§©çŸ©é˜µï¼Œå°½å¯èƒ½å»é€¼è¿‘åŸæœ‰çš„å¸¦æœ‰ç¼ºå¤±å€¼çš„çŸ©é˜µã€‚åœ¨ä¸Šä¸€æ¬¡ä½œä¸šä¸­ï¼Œ æˆ‘ä»¬é‡‡ç”¨äº†æ ¸èŒƒæ•°å‡¸æ¾å¼›çš„æ–¹æ³•ï¼Œåœ¨æ¡ä»¶æŠ•å½±æ³•ä¸‹å‡å°‘äº†è®¡ç®—å¤æ‚åº¦ã€‚è€Œé‡‡ç”¨äº¤æ›¿æå°åŒ–æ–¹æ³•ä¾¿ä¸ éœ€è¦å¯¹é—®é¢˜è¿›è¡Œå‡¸æ¾å¼›äº†ã€‚

### ä½ç§©åˆ†è§£

â€‹	å¦‚æœXæ˜¯ä¸€ä¸ªmè¡Œnåˆ—çš„çŸ©é˜µï¼Œrank(X)æ˜¯Xçš„ç§©ï¼Œå‡å¦‚rank(X)è¿œå°äºmå’Œnï¼Œåˆ™ç§°Xä¸ºä½ ç§©çŸ©é˜µã€‚ä½ç§©çŸ©é˜µåŒ…å«äº†å¤§é‡å†—ä½™ä¿¡æ¯ã€‚ä½ç§©åˆ†è§£ç›®çš„å³ä¸ºå»é™¤å†—ä½™ï¼Œå¹¶å‡å°‘æƒå€¼å‚æ•°ã€‚

â€‹	åœ¨ä½ç§©åˆ†è§£ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸å®šä¹‰å¦‚ä¸‹ç›®æ ‡å‡½æ•°ï¼š
$$
\min _{\operatorname{rank}(M) \leq k} f(M)
$$
â€‹	$f: \mathbb{R}^{m \times n} \rightarrow \mathbb{R}$ã€‚äº‹å®ä¸Šï¼Œå¯¹äºä½ç§©çŸ©é˜µ M, rankM = k è€Œè¨€ï¼Œä¸€å®šå¯ä»¥åšåˆ†è§£å¦‚ä¸‹:
$$
M=X Y^{T}, X \in \mathbb{R}^{m \times k}, Y \in \mathbb{R}^{n \times k}
$$
å› æ­¤ç»™å®šåˆå§‹å€¼ï¼Œäº¤æ›¿æå°åŒ–çš„è¿‡ç¨‹ä¾¿æ˜¯:
$$
\begin{array}{l}
X_{t}=\arg \min _{X} f\left(X Y_{t-1}^{\top}\right) \\
Y_{t}=\arg \min _{Y} f\left(X_{t} Y^{\top}\right)
\end{array}
$$
â€‹	å…·ä½“æˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå¯¹äºä¸€ä¸ªå«æœ‰ç¼ºå¤±å€¼çš„å¹¶ä¸”ç§©è¾ƒä½çš„çŸ©é˜µ $A \in \mathbb{R}^{m \times n}$ (ç¼ºå¤±å€¼ç”±é›†åˆ Î© æè¿°ï¼Œè¡¨ç¤ºç›¸åº”ä½çŸ©é˜µå…ƒç´ ä¸º 0 çš„çŸ©é˜µç©ºé—´)ï¼Œæˆ‘ä»¬æƒ³è¦ä¼˜åŒ–ä»¥ä¸‹çš„ç›®æ ‡:
$$
\min _{X \in \mathbb{R}^{m \times k}, Y \in \mathbb{R}^{n \times k}} \frac{1}{2}\left\|P_{\Omega}\left(A-X Y^{\top}\right)\right\|_{F}^{2}
$$
å…¶ä¸­ï¼Œ$P_{\Omega}$ è¡¨ç¤ºä¸€ä¸ªçŸ©é˜µåˆ°ç¼ºå¤±çŸ©é˜µç©ºé—´ Î© çš„æŠ•å½±ã€‚åœ¨å¤„ç†é—®é¢˜ä¹‹å‰ï¼Œéœ€è¦åšå‡ºä¸¤ä¸ªå‡è®¾:
1. ç¼ºå¤±çš„å…ƒç´ éƒ½æ˜¯ç‹¬ç«‹ä¸”éšæœºçš„;
2. çŸ©é˜µ A çš„å¥‡å¼‚å‘é‡çš„ $l_{\infty}$ å€¼æ˜¯å¾ˆå°çš„ã€‚è¿™è¡¨æ˜ï¼ŒçŸ©é˜µçš„å…ƒç´ éƒ½æ˜¯æ¯”è¾ƒâ€œåˆ†æ•£â€çš„ã€‚

â€‹	è§‚å¯Ÿæˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ï¼Œå‘ç°å¯¹äºå›ºå®šçš„çŸ©é˜µ X è€Œè¨€ï¼ŒçŸ©é˜µ Y çš„ç¬¬ i è¡Œå‘é‡ $y_i$ åªä¸ $P_{\Omega}\left(A-X Y^{\top}\right)$ çš„ç¬¬ i åˆ—æœ‰å…³ï¼ŒF èŒƒæ•°æ˜¯å¯¹æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œç›´æ¥ç›¸åŠ çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜æ‹†åˆ†ä¸º n ä¸ªå­é—®é¢˜:	

â€‹	å…¶ä¸­ï¼Œ$a_i$ æ˜¯çŸ©é˜µ A çš„ç¬¬ i åˆ—å‘é‡ï¼Œ$s_i$ æ˜¯çŸ©é˜µ A çš„ç¬¬ i åˆ—å¯¹åº”çš„ç¼ºå¤±å€¼ä½ç½®çš„å‘é‡æè¿°ï¼Œæ˜¯ä¸€ä¸ª 0-1 çš„å·²çŸ¥å‘é‡ã€‚æ¯ä¸€ä¸ªå­é—®é¢˜å¾—åˆ°çš„ $y_i$ éƒ½ä½¿å¾—æœ€ç»ˆç›®æ ‡çŸ©é˜µçš„åˆ—å‘é‡çš„ 2-èŒƒæ•°æœ€å°ï¼ŒæŠŠ n ä¸ªå­é—®é¢˜ç›¸åŠ ï¼Œå¾—åˆ°çš„è§£ä¹Ÿä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚è€Œè¿™ä¸ªå­é—®é¢˜ç›¸å½“äºæ±‚è§£ k ç»´è¾“å…¥ m ç»´è¾“å‡ºæœ€å°äºŒä¹˜é—®é¢˜ã€‚ å› æ­¤æ­¤é—®é¢˜çš„ä¾¿å¾—åˆ°äº†è§£å†³æ–¹æ³•ã€‚

### é«˜æ–¯æ··åˆæ¨¡å‹

å½“æœŸæœ›æå¤§åŒ–ç®—æ³•åº”ç”¨äºæ¦‚ç‡å‚æ•°åŒ–æ¨¡å‹ $p(X,Z|\theta)$ æ—¶ï¼Œå³æœ€å¤§åŒ–
$$
\max _{\theta} E\left[\log p_{\theta}(X, Z) \mid X\right]
$$
å…¶ä¸­ï¼Œ *X* ä¸ºæ ·æœ¬æ•°æ®ï¼Œ *Z* ä¸ºæ¨¡å‹éšå«å˜é‡ï¼Œ$\theta$ ä¸ºæ¦‚ç‡æ¨¡å‹ä¼˜åŒ–å˜é‡(ä¾‹å¦‚å‡å€¼å’Œæ ‡å‡†å·®)ã€‚è€ƒè™‘æ··åˆé«˜æ–¯åˆ†å¸ƒï¼Œå³ K ä¸ªé«˜æ–¯åˆ†å¸ƒçš„çº¿æ€§ç»„åˆï¼Œéšå«å˜é‡ Z è¡¨ç¤ºæ ·æœ¬ æ‰€å±çš„ç¬¬Zä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œï± $\theta=\left\{\mu_{i}, \Sigma_{i}, \pi_{i}\right\}_{i=1}^{K}$ï¼Œå…¶ä¸­ $\mu_i$ ä¸ºå‡å€¼ï¼Œ$\sum_i$ ä¸ºåæ–¹å·®ï¼Œ$\pi_i$ ä¸ºæ··åˆé«˜æ–¯åˆ†å¸ƒçš„æƒé‡ã€‚å› æ­¤
$$
\begin{array}{c}
p_{\theta}\left(x_{i}\right)=\sum_{z=1}^{K} \pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right) \\
N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)=\frac{1}{(2 \pi)^{\frac{D}{2}}\left|\Sigma_{z}\right|^{\frac{1}{2}}} \exp \left\{-\frac{\left(x_{i}-\mu_{z}\right)^{T} \Sigma_{z}^{-1}\left(x_{i}-\mu_{z}\right)}{2}\right\}
\end{array}
$$
å…¶ä¸­ D ä¸ºæ ·æœ¬å‘é‡ç»´åº¦ï¼Œç”±äºæ ·æœ¬ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå¯¹æ•°å½¢å¼çš„æœ€å¤§ä¼¼ç„¶å‡½æ•°ä¸º:æ‰€æœ‰æ ·æœ¬æ¦‚ç‡è¿ä¹˜åå–å¯¹æ•°
$$
\theta=\underset{s . t \sum \pi_{z}=1}{\arg \max } f(\theta)=\underset{s . t \sum \pi_{z}=1}{\arg \max } \sum_{i=1}^{n} \ln \left[p_{\theta}\left(x_{i}\right)\right]
$$
å¯¹è¯¥å‡½æ•°æ±‚æœ€å¤§å€¼ï¼Œå¼•å…¥æ‹‰æ ¼æœ—æ—¥å‡½æ•°
$$
L(\theta, \lambda)=\sum_{i=1}^{n} \ln \left[p_{\theta}\left(x_{i}\right)\right]+\lambda\left[\sum \pi_{z}-1\right]
$$
åˆ†åˆ«é’ˆå¯¹ $\theta$ ä¸‰ä¸ªå‚æ•°æ±‚å¯¼
$$
\begin{array}{c}
\nabla L_{\pi_{z}}(\theta, \lambda)=\sum_{i=1}^{n} \frac{N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}{\sum_{z=1}^{K} \pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}+\lambda=0 \\
\nabla L_{\mu_{z}}(\theta, \lambda)=-\sum_{i=1}^{n} \frac{\pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}{\sum_{z=1}^{K} \pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)} \Sigma_{z}^{-1}\left(x_{i}-\mu_{z}\right)=0 \\
\nabla L_{\Sigma_{z}}(\theta, \lambda)=\sum_{i=1}^{n} \frac{\pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}{K}\left(-\frac{1}{2 \Sigma_{z}}+\frac{\left(x_{i}-\mu_{z}\right)^{T}\left(x_{i}-\mu_{z}\right)}{2 \Sigma_{z}^{2}}\right)=0
\end{array}
$$
ç”±è´å¶æ–¯å®šç†å¾—ï¼š
$$
p_{\theta}\left(z \mid x_{i}\right)=\frac{\pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}{\sum_{z=1}^{K} \pi_{z} N\left(\mu_{z}, \Sigma_{z}\right)\left(x_{i}\right)}
$$
å› æ­¤
$$
\begin{array}{l}
\pi_{z}=\frac{\sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right)}{\sum_{z=1}^{K} \sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right)} \\
\mu_{z}=\frac{\sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right) x_{i}}{\sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right)} \\
\Sigma_{z}=\frac{\sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right)\left(x_{i}-\mu_{z}\right)^{T}\left(x_{i}-\mu_{z}\right)}{\sum_{i=1}^{n} p_{\theta}\left(z \mid x_{i}\right)} \\
\end{array}
$$

### ä¼˜åŒ–æ–¹æ³•

#### äº¤æ›¿æå°åŒ–

â€‹	å½“ç§©ä¸ºkçš„çŸ©é˜µMå¯ä»¥è¢«åˆ†è§£ä¸º $M=XY^{T}$ çš„å½¢å¼æ—¶ ($X \in \mathbb{R}^{m \times k}, \quad Y \in \mathbb{R}^{n \times k}$),ç»™å®šåˆå§‹å‚æ•°çŸ©é˜µ $X_0$ å’Œ $Y_0$ ï¼Œäº¤æ›¿ä¼˜åŒ–çŸ©é˜µ *X* å’Œ*Y*
$$
\begin{array}{l}
X_{t}=\arg \min _{X} f\left(X Y_{t-1}^{T}\right) \\
Y_{t}=\arg \min _{Y} f\left(X_{t} Y^{T}\right)
\end{array}
$$
â€‹	ä»¥å›ºå®šXä¸ºä¾‹ï¼š
$$
Y_{t}=\underset{Y \in \mathbb{R}^{n k}}{\arg \min } \frac{1}{2}\left\|P_{\Omega}\left(A-X_{t} Y^{T}\right)\right\|_{F}^{2}
$$
â€‹	ç”±äºçŸ©é˜µçš„FèŒƒæ•°çš„å¹³æ–¹ä¸ºå„å…ƒç´ çš„å¹³æ–¹å’Œï¼ŒYä¸­çš„ç¬¬iè¡Œåªå‡ºç°åœ¨ $P_{\Omega}\left(A-X_{t} Y^{T}\right)$â€‹ ä¸­çš„ç¬¬ i åˆ—ï¼Œè¯¥é—®é¢˜å¯ä»¥æŒ‰åˆ—è¿›è¡Œä¼˜åŒ–ï¼Œä¾æ­¤å¾—åˆ° Y æ¯è¡Œçš„å…ƒç´ ï¼Œæœ€åç»„åˆèµ·æ¥ å½¢æˆ Yï¼Œå› æ­¤ç¬¬ i åˆ—çš„ä¼˜åŒ–é—®é¢˜ä¸º
$$
\min _{y_{i} \in \mathbb{R}^{k}}\left\|s_{i} \times\left(a_{i}-X_{t} y_{i}\right)\right\|_{2}^{2}
$$
â€‹	å°†ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºæœ€å°äºŒä¹˜è§£çš„é—®é¢˜ã€‚

#### æœ€å¤§æœŸæœ›æ³• EMç®—æ³•

â€‹	EMç®—æ³•ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼š

1. æ±‚è§£æœŸæœ›

$$
\text { æ ¹æ®å½“å‰çš„ } \pi_{z}{ }^{(t)} ã€ \mu_{z}{ }^{(t)} \text { å’Œ } \Sigma_{z}{ }^{(t)} \text { æ±‚æœŸæœ› } p_{\theta^{(t)}}\left(z \mid x_{i}\right)
$$

2. æå¤§åŒ–

$$
\begin{array}{l}
\pi_{z}^{(t+1)}=\frac{\sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right)}{\sum_{z=1}^{K} \sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right)} \\
\mu_{z}^{(t+1)}=\frac{\sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right) x_{i}}{\sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right)} \\
\Sigma_{z}^{(t+1)}=\frac{\sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right)\left(x_{i}-\mu_{z}^{(t+1)}\right)^{T}\left(x_{i}-\mu_{z}^{(t+1)}\right)}{\sum_{i=1}^{n} p_{\theta^{(t)}}\left(z \mid x_{i}\right)} \\
\end{array}
$$



### å®éªŒå’Œç»“æœ

#### é‡‡ç”¨äº¤æ›¿æå°åŒ–è¿›è¡Œä½ç§©çŸ©é˜µè¡¥å…¨

â€‹	é¦–å…ˆç”Ÿæˆéœ€è¦åˆ†è§£çš„ä½ç§©çŸ©é˜µAï¼Œå¦‚ä¸‹ï¼š

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218150732800.png" alt="image-20221218150732800" style="zoom:70%;" />

è¦è¿˜åŸçš„çŸ©é˜µå¦‚ä¸‹:

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218150916176.png" alt="image-20221218150916176" style="zoom:40%;" />

| è¿­ä»£æ¬¡æ•° | ç»“æœ                                                         |
| -------- | ------------------------------------------------------------ |
| 1        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151117495.png" alt="image-20221218151117495" style="zoom:40%;" /> |
| 2        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151225888.png" alt="image-20221218151225888" style="zoom:40%;" /> |
| 3        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151248935.png" alt="image-20221218151248935" style="zoom:40%;" /> |
| 4        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151310271.png" alt="image-20221218151310271" style="zoom:40%;" /> |
| 5        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151321626.png" alt="image-20221218151321626" style="zoom:40%;" /> |
| 6        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151333057.png" alt="image-20221218151333057" style="zoom:40%;" /> |
| 7        | <img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151543204.png" alt="image-20221218151543204" style="zoom:40%;" /> |

â€‹	å¯¹æä¾›çš„æ–‡æ¡£ä¸­çš„çŸ©é˜µè¿›è¡Œåˆ†æå‘ç°ï¼Œå¯¹äºç§©ä¸º 2 çš„çŸ©é˜µï¼Œè¿­ä»£ 5 å³ å¯è¾¾åˆ°è¾ƒå¥½çš„è¿˜åŸæ•ˆæœï¼Œå› æ­¤åœ¨è‡ªå·±çš„ä»¿çœŸå®éªŒä¸­åªè¿›è¡Œ 6 æ¬¡è¿­ä»£ï¼Œå¯ä»¥å‘ç°çŸ© é˜µçš„äº¤æ›¿æå°åŒ–è¡¥å…¨æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œè¿˜åŸçš„çŸ©é˜µä¸åŸçŸ©é˜µå‡ ä¹å®Œå…¨ç›¸åŒã€‚å°†äº¤æ›¿æå°åŒ–çš„ç»“æœä¸æ ¸èŒƒæ•°çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œäº¤æ›¿æå°åŒ–ç»“æœå¦‚ä¸‹:

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151754621.png" alt="image-20221218151754621" style="zoom:50%;" />

â€‹	æ ¸èŒƒæ•°ç»“æœå¦‚ä¸‹:

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218151852961.png" alt="image-20221218151852961" style="zoom:50%;" />





#### EMç®—æ³•å‚æ•°ä¼°è®¡

â€‹	ç”Ÿæˆé«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„æ ·æœ¬ç›´æ–¹å›¾å¦‚ä¸‹ï¼š

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218153345345.png" alt="image-20221218153345345" style="zoom:50%;" />

é‡‡ç”¨EMæ–¹æ³•å¾—åˆ°å¯¹æ•°æœ€å¤§ä¼¼ç„¶å‡½æ•°å€¼çš„å˜åŒ–æ›²çº¿ï¼š

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218153505973.png" alt="image-20221218153505973" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218153547369.png" alt="image-20221218153547369" style="zoom:40%;" />

é‡‡ç”¨è€ƒè™‘ 2 ç»´ 4 å‡å€¼(4-mean)é«˜æ–¯åˆ†å¸ƒçš„æ··åˆæ¨¡å‹ï¼Œå¯ä»¥çœ‹å‡ºå››ä¸ªç°è‰²åŒºåŸŸè¾ƒå¥½åˆ†éš”å¼€äº†ç”Ÿ æˆçš„æ ·æœ¬ï¼ŒEM æ–¹æ³•è¾ƒå¥½ä¼°è®¡äº†é«˜æ–¯æ¨¡å‹çš„å‚æ•°ã€‚

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20221218153715618.png" alt="image-20221218153715618" style="zoom:50%;" />