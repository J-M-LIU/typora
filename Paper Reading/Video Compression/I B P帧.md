# 视频压缩：I帧、P帧、B帧

​	I帧是关键帧，属于帧内压缩。P是向前搜索。B是双向搜索。他们都是基于I帧来压缩数据。采用的压缩方法：分组，把几帧图像分为一组(GOP),为防止运动变化,帧数不宜取多。定义帧：将每组内各帧图像定义为三种类型,即I帧、B帧和P帧；预测帧：以I帧做为基础帧,以I帧预测P帧,再由I帧和P帧预测B帧；数据传输：最后将I帧数据与预测的差值信息进行存储和传输。

![图2.带有I帧、B帧和P帧的典型视频序列。P帧只需要参考前面的I帧或P帧，而B帧则需要同时参考前面和后面的I帧或P帧。](https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/1208470.jpg)

## I帧

​	I帧表示关键帧，可理解为这一帧画面的完整保留；解码时只需要本帧数据就可以完成。I帧是靠尽可能去除图像空间冗余信息来压缩传输数据量的帧内编码图像。I帧又称为内部画面 (intra picture)，通常是每个 GOP的第一个帧。在MPEG编码的过程中部分视频帧序列压缩成为I帧，部分压缩成P帧，还有部分压缩成B帧。

### I帧编码流程

1. 进行帧内预测，决定所采用的帧内预测模式。

2. 像素值减去预测值，得到残差。

3. 对残差进行变换和量化。

4. 变长编码和算术编码。

5. 重构图像并滤波，得到的图像作为其它帧的参考帧。

## P帧

​	P帧表示的是这一帧跟之前的一个关键帧（或P帧）的差别，解码时需要用之前缓存的画面叠加上本帧定义的差别，生成最终画面。

<img src="https://img-blog.csdnimg.cn/20191226210120570.png" style="zoom: 80%;" />

### P帧的预测与重构

​	P帧是以I帧为参考帧，在I帧中找出P帧“某点”的预测值和运动矢量，取残差和运动矢量一起传送。在接收端根据运动矢量从I帧中找出P帧“某点”的预测值并与差值相加以得到P帧“某点”样值,从而可得到完整的P帧。

### P帧的特点

（1）P帧是I帧后面相隔1-2帧的编码帧。 

（2）P帧采用运动补偿的方法传送它与前面的I或P帧的**差值及运动矢量（预测误差）**。 

（3）解码时必须将I帧中的预测值与预测误差求和后才能重构完整的P帧图像。 

（4）P帧属于前向预测的帧间编码。它只参考前面最靠近它的I帧或P帧。 

（5）P帧可以是其后面P帧的参考帧，也可以是其前后的B帧的参考帧。

（6）由于P帧是参考帧，它可能造成解码错误的扩散。 

（7）由于是差值传送，P帧的压缩比较高。



## B帧

​	B帧以前面的I或P帧和后面的P帧为参考帧,“找出”B帧“某点”的预测值和两个运动矢量,并取预测差值和运动矢量传送。接收端根据运动矢量在两个参考帧中“找出(算出)”预测值并与差值求和,得到B帧“某点”样值,从而可得到完整的B帧。

![](https://img-blog.csdnimg.cn/20191226210242870.png)

### B帧特点

（1）B帧是由前面的I或P帧和后面的P帧来进行预测的；

（2）B帧传送的是它与前面的I或P帧和后面的P帧之间的预测误差及运动矢量；

（3）B帧是双向预测编码帧；

（4）B帧压缩比最高,因为它只反映2参考帧间运动主体的变化情况,预测比较准确；

（5）B帧不是参考帧,不会造成解码错误的扩散。

### P帧和B帧编码的流程

(1)进行运动估计，计算采用帧间编码模式的率失真函数(节)值。P 帧只参考前面的帧，B帧可参考后面的帧。

(2)进行帧内预测，选取率失真函数值最小的帧内模式与帧间模式比较，确定采用哪种编码模式。

(3)计算实际值和预测值的差值。

(4)对残差进行变换和量化。

(5)若编码，如果是帧间编码模式，编码运动矢量。

