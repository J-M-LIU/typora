# Instance-Aware Dynamic Neural Network Quantization



## Introduction

在大多数现有的量化方法中，每一层的位宽都是静态的，即对给定数据集中的所有样本都是相同的。然而，自然图像具有巨大的多样性和丰富的内容，对所有样本使用这种通用的量化配置并不是最优的策略。本文提出对每幅图像分别进行低比特量化，并开发了一种动态量化方案来探索它们的最佳比特宽度。为此，建立一种轻量级的bit controller，并与给定的待量化神经网络联合训练。在推理过程中，任意图像的量化配置将由bit controller生成的位宽决定，例如，具有简单纹理的图像将以较低的位和计算复杂度分配，反之亦然。在基准数据集上的实验结果表明，所提出的动态量化方法在精度和计算复杂度方面取得了最优的性能。

虽然上述方法为提高低比特量化网络的性能做出了巨大努力，但通常忽略了给定数据集中每个实例的多样性。事实上，如何有效地处理困难和简单的例子是计算机视觉中一个普遍存在的问题，特别是在视觉识别任务中，如[35,37]所讨论的。为此，Wu等人[44]建议在推理过程中从预训练网络中选择一小部分层，以降低整体计算复杂度。Cheng et al.[7]指出，单一的网络架构对于给定数据集中的所有样本来说是不够代表性的，因此提出了一种实例级的网络变异算法。这些方法主要是基于使用深度神经网络处理不同样本所需的资源往往是不同的这一事实而开发的。例如，一个训练良好的网络很容易识别只包含一只狗的图像，但很难识别街景中被遮挡的自行车。本文旨在探索一种实例感知的动态方法，可以提供更好的性能和计算复杂性权衡。

本文提出一种新的网络量化方案，根据图2所示的每个输入样本动态分配量化神经网络中的比特宽度。具体而言，给定的网络结构将派生出大量具有不同位宽配置的隐藏子网络。在推理过程中，将难以准确识别的图像分配给较大的网络，反之亦然。对于任意图像，比特控制器用于预测其所有层的权值和激活值的最佳比特宽度序列。位控制器采用轻量级结构设计，可以忽略其额外的计算开销。量化神经网络与位控制器以端到端的方式进行训练，以获得更好的性能。由于动态量化网络(dynamic quantized network, DQNet)可以根据不同的输入图像提供最优的位宽配置，因此可以大大减少处理每个样本的计算量。与传统的静态量化方法相比，动态分配计算资源可以在计算代价和精度之间取得更好的平衡。在CIFAR-10和ImageNet数据集上进行的大量实验表明，DQNet可以在消耗更少计算资源的同时达到与静态量化方法相近甚至更好的分类精度。

