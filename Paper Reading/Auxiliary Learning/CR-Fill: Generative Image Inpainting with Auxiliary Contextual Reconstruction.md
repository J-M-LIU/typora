# CR-Fill: Generative Image Inpainting with Auxiliary Contextual Reconstruction



## Introduction

图像修复是预测图像中缺失区域的任务。传统方法从已知区域或外部数据集借用示例patch并粘贴到缺失区域，但在涉及复杂、非重复结构的挑战性案例中，无法产生新的图像内容。

CNN中，对于图像修复，可通过故意损坏图像并使用损坏前的原始图像作为真值来自动生成无限量的配对训练数据。但一个重要挑战是，在自然图像中填补一个缺失区域有很多可能的答案，这种模糊性常常导致模糊或扭曲的结构。为了克服这个问题，最近的工作试图通过明确分配一个已知区域作为参考来填补一个缺失区域来减少不确定性。

但在contextual attention CA模块中，没有对特征相似性或patch对应关系的直接监督，因此有时会选择不适当的patch，导致修复结果中出现伪影。特别是在CA层中的patch-borrowing操作需要计算feature map中每对patch的相似性，然而这样会产生很高的计算消耗，尤其是对于高分辨率的图像。

为了解决这些问题，考虑避免在修复生成器中使用的patch-borrowing，同时通过上下文重建的联合训练来保留和鼓励patch/特征复制粘贴的行为。本文提出将一个辅助的上下文重建分支附加到修复网络作为一个新的训练损失。这一损失不仅鼓励生成的缺失区域的单个特征能从周围区域的特征重建，而且鼓励完整的上下文重建复合在视觉上是合理的。

**contributions**：

- 可学习的辅助上下文重建分支/损失（CR损失），以鼓励生成器借用适当的已知区域作为填补缺失区域的参考。
- 无注意力修复生成器，与传统的修复损失和辅助的上下文重建损失一起进行联合训练，辅助分支在推理时去除，实现高效推理。



