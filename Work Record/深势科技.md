

**业务需求：**

1. 可以支持二次开发，开源
2. 数据源共享

**大模型落地：**

1. 大模型训练、微调、部署，大模型agent等的系统方法论。
2. 如何结合业务知识。



- 大原子模型：**DPA**预训练大模型
- 分子大模型：**Uni-Mol**基于分子三维结构预测分子的各种物理化学性质
- 配方大模型：**Uni-ELF**
- 蛋白大模型：Uni-Fold
- 基因大模型：Uni-RNA



## 前序：AlphaFold

解决蛋白质折叠问题，可以抽象成如下： 
输入：Alpha Fold的输入是一个氨基酸序列，每一个位置的元素代表了链上的一个氨基酸单元（一共可以有21种氨基酸单元），一个典型的输入如下，代表是一个包含59个氨基酸的链：

> PIAQIHILEGRSDEQKETLIREVSEAISRSLDAPLTSVRVIITEMAKGHFGIGGELASK

输出：在接收到这个单一序列的输入之后，AlphaFold需要使用算法，预测这一个氨基酸链条会如何折叠，所以输出的是一个拓扑结构，上面这段氨基酸输入经过AlphaFold模型运算之后输出的氨基酸拓扑结构可视化如下：

<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20251218103939089.png" alt="image-20251218103939089" style="zoom: 33%;" />

输出为结构化的数据。准确的说，输出的数据是每一个氨基酸单元和其下一个氨基酸单元在空间中的夹角，由于是三维空间，所以说明一个方位需要2维数据，(φ, ψ)，所以AlphaFold的模型的输出就是一组数量和输入对应的夹角对：
$$
(\phi1,\psi1),(\phi2,\psi2),(\phi3,\psi3),(\phi4,\psi4),\ldots
$$
如果输入的是k个氨基酸，那么输出的就是k-1个夹角对，比如上文中输入是59个氨基酸组成的氨基酸链，那么就应该输出58个夹角对。



## 大原子模型：DPA预训练模型（多层图神经网络）

核心任务：**势能面**建模 (PES Modeling)与**分子动力学模拟**。模型通过预测原子体系的能量和受力，驱动分子动力学 (MD) 模拟 。具体的应用场景包括：

- **电池材料模拟：**

  **固态电解质：** 模拟锂离子在 Li10SnP2S12 中的扩散过程，计算扩散系数，这对于开发全固态电池至关重要 。

  **正极材料：** 模拟 LixTMO2 等层状氧化物正极材料的性质 。

- **半导体材料：**预测 IIB 到 VIA 族半导体（如 Si, Ge, GaN 等）在不同温度压力下的性质 。

- **合金设计：**模拟铝镁铜 (Al-Mg-Cu) 合金的结构和性质 。

- **铁电材料相变：**研究钙钛矿氧化物（如 PIN-PMN-PT）随温度变化的相变过程（从四方相到立方相的转变）。

- **基础物理化学：**

  **水/冰模拟：** 极其精准地重现水的径向分布函数 (RDF) 和角分布函数 (ADF)，其精度几乎等同于昂贵的从头算 (AIMD) 。

### 核心学习目标：能量、受力与维里

DPA-3 是一个回归模型，它的训练目标非常明确且符合物理直觉：

- 输入： 原子的类型（化学元素）和坐标（3D 几何结构）。
- 输出： 预测系统的**总能量**、每个原子的**受力**以及周期性系统的**维里张量**。
- 物理约束： DPA-3 被设计为严格遵守能量守恒（力是能量的负梯度），并满足平移、旋转和置换不变性。

## 分子大模型 Uni-Mol（Universal 3D Molecular Representation Learning Framework）

Uni-Mol（Universal 3D Molecular Representation Learning Framework）是一个**通用的3D分子表征学习框架**。

主要作用是利用深度学习（Transformer架构）来理解和处理分子的**三维结构信息**，从而帮助科研人员完成各种与药物发现和分子设计相关的任务。

主要功能和用途：

1. **分子性质预测 (Molecular Property Prediction)**
   - 这是最常见的作用。Uni-Mol可以预测分子的各种物理化学性质（如溶解度、毒性、量子化学性质等）。由于它引入了3D结构信息，相比仅使用2D图（Graph）或SMILES字符串的模型，它通常能提供更准确的预测。
2. **3D空间结构任务**
   - **蛋白-配体结合构象预测 (Protein-Ligand Binding Pose Prediction)**：也就是常说的**分子对接 (Docking)**。Uni-Mol能够预测药物分子在蛋白质口袋中的结合姿态，这对于基于结构的药物设计（SBDD）非常关键。
   - **分子构象生成 (Molecular Conformation Generation)**：生成分子在三维空间中合理的几何结构。
3. **分子表征提取 (Representation Learning)**
   - 它可以作为一个预训练模型（Pre-trained Model），将分子转化为计算机可以理解的高维向量（Embedding）。这些向量可以被用于各种下游任务，不仅限于官方提供的任务，还可以用于聚类、相似度搜索等。
4. **核心技术特点**
   - **3D优先**：不同于许多只关注2D拓扑结构的GNN模型，Uni-Mol核心在于利用分子的三维坐标。
   - **大规模预训练**：它在数亿个分子构象和数百万个蛋白口袋数据上进行了预训练，因此具有很强的泛化能力。
   - **SE(3) 等变性**：采用SE(3)-Transformer架构，保证了模型对分子的旋转和平移具有不变性/等变性，符合物理规律。



<img src="https://cdn.jsdelivr.net/gh/J-M-LIU/pic-bed@master//img/image-20251218151435082.png" alt="image-20251218151435082" style="zoom:35%;" />

## MMPloymer 聚合物材料性质预测





## Uni-ELF 高分子配方性质预测

### 模型要解决什么问题

Uni-ELF 旨在解决**配方设计**中的核心痛点：传统的“试错法”效率太低，且配方数据稀缺、异构。

- **配方的特殊性**： 配方不像单个分子那样有固定的化学键连接（图结构），也不像自然语言那样有固定的语法顺序。配方是一个无序的列表，包含多种成分和各自的配比。
- **传统方法局限：** 传统机器学习方法（如随机森林、简单神经网络）很难处理变长的输入（配方里有时加3种料，有时加10种料），也很难捕捉成分之间复杂的相互作用 。
- **核心目标**：建立一个通用的预训练模型，能够理解“成分+配比”的内在规律，从而实现**自动配方生成**和**精准的性质预测**。

### 预训练任务：掩码元素预测 Masked Element Prediction, MEP

类似于 BERT 训练语言模型，Uni-ELF 的预训练使用了**掩码策略**：

- **做法：** 拿来一个真实的配方，随机“挖掉”其中某个成分（Mask Token）或者“盖住”某个成分的比例。
- **目标：** 让模型去猜“这里原本应该是什么成分？”或者“这个成分应该加多少比例？”
- **训练数据：** 使用了大规模的无标签配方数据进行预训练，使其学会通用的混合规律 。

### 输入输出

**输入：**一个配方列表，形式为$\{(C_1,r_1),(C_2,r_2),...,(C_N,r_N)\}$。

- $C_i$：第$i$个成分的 ID 或化学结构嵌入。

- 
  $r_i$：第$i$个成分的比例/数值。


- 条件 (Condition)：还可以输入希望达到的工艺条件 (如温度、压力)。

**输出：**根据下游任务不同，输出可以是：

- **性质预测（回归）：** 输入一个完整配方，输出它的物理化学性质（如橡胶的硬度、混凝土的抗压强度、药膏的释放率）。
- **配方补全（生成）：** 输入部分成分（比如“我要用橡胶和炭黑”），输出**建议添加的其他助剂**以及**所有成分的最佳比例** 。

### 总结：Uni-ELF 的角色

如果把化学研发比作烹饪：

- **Uni-Mol** 帮你研发新的“食材”（分子）。
- **Uni-ELF** 则是**超级大厨**，它告诉你如何把这些食材搭配起来，加多少盐、多少糖，才能做出一道口味（性质）完美的“菜肴”（最终产品）。









